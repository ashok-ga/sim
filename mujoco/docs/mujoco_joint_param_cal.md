# MuJoCo Joint Parameter Calculation

This README explains how to derive key MuJoCo joint parameters—**armature**, **frictionloss**, **actuatorfrcrange**, **range**, and the **position actuator gains** (**kp**, **kv**)—from your CAD models, motor datasheets, and control requirements.

---

## 📦 Project Structure

```
/your-mujoco-project
│
├── models/
│   └── humanoid.xml        # Your MuJoCo model using <default> blocks
│
├── docs/
│   └── Calculating_MuJoCo_Joint_Parameters.md  # Detailed derivation guide
│
└── README.md              # (this) overview and quick reference
```

---

## 🔑 Parameter Definitions

| Parameter           | What it is                                      | Source                    |
|---------------------|-------------------------------------------------|---------------------------|
| **armature**        | Joint’s rotational inertia (kg·m²)               | CAD inertia tensor        |
| **frictionloss**    | Viscous damping (N·m·s/rad)                     | No-load torque test       |
| **actuatorfrcrange**| Motor torque limits (N·m)                       | Motor datasheet           |
| **range**           | Angular or linear travel limits                 | CAD or physical test      |
| **kp**, **kv**      | PD gains for position actuator                  | Desired rise time + `I`   |

---

## 🧮 Quick Calculation Recipes

1. **Armature**
   ```
   # from CAD
   I_com = inertia tensor about COM
   axis = unit vector of joint axis
   I_motor = axis^T * I_com * axis
   # reflect gearbox
   I_joint = I_motor * (gear_ratio)^2
   ```

2. **Frictionloss**
   ```
   # run motor+gear at angular speed omega (rad/s), measure torque T_f
   b = T_f / omega
   ```

3. **Actuatorfrcrange**
   ```
   # datasheet values
   tau_rated = continuous torque
   tau_peak  = stall/peak torque
   actuatorfrcrange = [-tau_rated, +tau_rated]
   # or use tau_peak for short bursts
   ```

4. **Range**
   ```xml
   <joint range="lower upper"/>  <!-- in radians -->
   ```

5. **PD Gains (kp, kv)**
   ```
   # choose desired rise time t_r
   omega_n = 1.8 / t_r
   kp = I_joint * omega_n^2
   kv = 2 * I_joint * omega_n
   ```

---

## ⚙️ Integration into MuJoCo

In your `<default>` block:

```xml
<default class="your_joint_class">
  <joint
    armature="<I_joint>"
    frictionloss="<b>"
    actuatorfrcrange="-<tau> <tau>"
    range="<lower> <upper>"
  />
  <position kp="<kp>" kv="<kv>"/>
</default>
```

Replace `<…>` with your calculated values.

---

## 📖 Further Reading
- **docs/Calculating_MuJoCo_Joint_Parameters.md** — step-by-step guide with formulas and examples.
- MuJoCo Reference Manual — details on XML schema and actuator definitions.

---

## 🛠️ Tips & Troubleshooting
- **Inertia accuracy:** export dense mesh-based inertia from CAD for best fidelity.
- **Friction measurement:** average multiple speed/torque readings to reduce noise.
- **Gain tuning:** start with critical damping formulas, then refine in simulation for overshoot and settling.

---

> _Generated by the MuJoCo Joint Parameter Calculation toolkit_  
> _© 2025 Your Lab / Company_
